# Excel 列删除工具 - 使用说明

## 🚀 快速开始

### 方法一：一键启动（推荐）
双击 `start-all.bat` 文件，系统会自动：
1. 检查 Python 和 Node.js 环境
2. 安装后端依赖
3. 启动后端服务（端口 8001）
4. 安装前端依赖  
5. 启动前端服务（端口 3000+）

### 方法二：分别启动
1. **启动后端**：双击 `start-backend.bat`
2. **启动前端**：双击 `start-frontend.bat`

### 方法三：手动启动
```bash
# 启动后端
cd backend
pip install -r requirements.txt
cd app
python main.py

# 启动前端（新终端）
cd frontend
npm install
npm run dev
```

## 📋 环境要求

- **Python 3.8+** （用于后端服务）
- **Node.js 16+** （用于前端构建）
- **现代浏览器** Chrome 86+ 或 Edge 86+（支持文件保存 API）

## 🎯 使用步骤

1. **访问应用**
   - 打开浏览器访问前端地址（启动时会显示具体端口）

2. **选择文件**
   - 点击"选择 Excel 文件"按钮
   - 选择 .xlsx 或 .xls 格式的文件
   - 系统会自动预览文件的所有列信息

3. **选择要删除的列**
   - 查看每列的名称和示例数据
   - 勾选要删除的列（支持多选）
   - 可以使用"全选/取消全选"快速操作

4. **处理文件**
   - 点击"删除选中的X列并保存"按钮
   - 等待处理完成

5. **保存文件**
   - 系统会弹出保存对话框
   - 选择保存位置和文件名
   - 原文件不会被修改

## 📊 界面特性

### 🎨 移动端适配
- **响应式设计**：自动适配手机、平板、电脑屏幕
- **触摸友好**：大按钮设计，易于点击
- **流畅动画**：现代化的交互效果

### 📋 列预览功能
- **自动预览**：选择文件后自动显示所有列
- **列信息展示**：显示列名、列索引、示例数据
- **可视化选择**：通过勾选框选择要删除的列
- **批量操作**：支持全选/取消全选

### 💡 用户体验
- **实时反馈**：操作状态实时显示
- **错误提示**：详细的错误信息和解决建议
- **进度显示**：处理过程中显示加载动画
- **成功确认**：操作完成后的明确提示

## 📊 示例测试

项目包含一个示例文件 `sample-data.xlsx`，包含以下列：

| 列号 | 列名 | 示例数据 |
|------|------|----------|
| 1 | 姓名 | 张三, 李四, 王五 |
| 2 | 年龄 | 28, 32, 25 |
| 3 | 部门 | 技术部, 技术部, 设计部 |
| 4 | 职位 | 软件工程师, 高级工程师, UI设计师 |
| 5 | 工资 | 12000, 18000, 10000 |
| 6 | 入职日期 | 2023-01-15, 2022-03-20, 2023-05-10 |
| 7 | 备注 | React开发, Python后端, 界面设计 |

**测试建议：**
- 删除部门列：勾选"部门"
- 删除部门和工资列：勾选"部门"和"工资"
- 删除多个列：勾选"年龄"、"职位"、"入职日期"

## 🔧 功能特性

- ✅ **多格式支持**：支持 .xlsx 和 .xls 文件
- ✅ **列预览**：自动显示所有列的名称和示例数据
- ✅ **可视化选择**：通过勾选框选择要删除的列
- ✅ **批量操作**：支持全选/取消全选
- ✅ **样式保持**：保留原有的字体、颜色、边框等样式
- ✅ **合并单元格**：智能处理合并单元格的调整
- ✅ **移动端适配**：响应式设计，支持手机和平板
- ✅ **本地保存**：使用浏览器原生 API 保存文件
- ✅ **原文件保护**：不会修改原始文件
- ✅ **错误处理**：完善的错误提示和处理

## 🌐 API 接口

### 预览列接口
- **URL**: `POST /api/excel/preview`
- **参数**: 
  - `file`: Excel 文件（multipart/form-data）
- **响应**: 包含列信息的JSON对象

### 删除列接口
- **URL**: `POST /api/excel/delete-columns`
- **参数**: 
  - `file`: Excel 文件（multipart/form-data）
  - `columns`: 列索引字符串（如："3,5"）
- **响应**: 处理后的 Excel 文件

### 其他接口
- `GET /`: API 基本信息
- `GET /health`: 健康检查
- `GET /api/excel/info`: Excel API 信息
- `GET /docs`: Swagger API 文档

## 🔍 故障排除

### 常见问题

**1. 端口被占用**
```
错误：Address already in use
解决：系统会自动选择可用端口，查看启动日志获取实际端口
```

**2. 文件预览失败**
```
错误：预览失败
解决：检查文件格式是否正确，确保是有效的Excel文件
```

**3. 列信息显示异常**
```
错误：列信息不完整
解决：确保Excel文件第一行包含列标题
```

**4. 移动端显示问题**
```
错误：页面显示不正常
解决：使用现代浏览器，清除缓存后重新访问
```

**5. 文件保存失败**
```
错误：showSaveFilePicker is not defined
解决：使用 Chrome 86+ 或 Edge 86+ 浏览器
```

### 测试后端服务

运行测试脚本检查后端是否正常：
```bash
python test-backend.py
```

### 查看日志

- **前端日志**：浏览器开发者工具 Console
- **后端日志**：终端输出

## 📱 移动端使用

### 手机浏览器
1. 使用 Chrome 或 Safari 浏览器
2. 访问前端地址
3. 界面会自动适配手机屏幕
4. 支持触摸操作和手势

### 平板设备
1. 支持横屏和竖屏模式
2. 列信息以网格形式展示
3. 触摸友好的大按钮设计

## 🎨 界面预览

应用界面包含：
- **顶部标题栏**：渐变色设计，显示工具名称
- **文件选择区域**：拖拽式文件选择框
- **列预览区域**：网格布局显示所有列信息
- **操作按钮**：大按钮设计，状态清晰
- **使用说明**：折叠式帮助信息

## 📞 技术支持

如遇到问题，请检查：
1. 环境要求是否满足
2. 服务是否正常启动
3. 浏览器是否支持
4. 文件格式是否正确
5. 网络连接是否正常

---

**祝您使用愉快！** 🎉